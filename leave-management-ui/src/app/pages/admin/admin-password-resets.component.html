<div class="admin-section-card mat-elevation-z2 password-resets-container">
  <div class="admin-section-header">
    <h2 class="admin-section-title">Password Reset Requests</h2>
  </div>
  <div *ngIf="isLoading" class="dashboard-loading">
    <mat-progress-spinner mode="indeterminate" color="primary"></mat-progress-spinner>
    <p>Loading requests...</p>
  </div>
  <div *ngIf="!isLoading && error" class="error-message">{{ error }}</div>
  <div *ngIf="!isLoading && !error">
    <table mat-table [dataSource]="requests" class="dashboard-table mat-elevation-z1">
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email</th>
        <td mat-cell *matCellDef="let req">{{ req.email }}</td>
      </ng-container>
      <ng-container matColumnDef="requestedAt">
        <th mat-header-cell *matHeaderCellDef>Requested At</th>
        <td mat-cell *matCellDef="let req">{{ req.requestedAt | date:'short' }}</td>
      </ng-container>
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td mat-cell *matCellDef="let req">
          <span [ngClass]="{
            'pending-status': req.status === 'pending',
            'approved-status': req.status === 'approved',
            'rejected-status': req.status === 'rejected'
          }">{{ req.status | titlecase }}</span>
        </td>
      </ng-container>
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>Actions</th>
        <td mat-cell *matCellDef="let req">
          <div class="action-btns" *ngIf="req.status === 'pending'">
            <input class="comment-input" [(ngModel)]="req.comment" placeholder="Add comment..." />
            <button mat-raised-button class="approve-btn" (click)="approve(req.id, req.comment)">Approve</button>
            <button mat-raised-button class="reject-btn" (click)="reject(req.id, req.comment)">Reject</button>
          </div>
          <span *ngIf="req.status === 'approved'" class="approved-status">Approved</span>
          <span *ngIf="req.status === 'rejected'" class="rejected-status">Rejected</span>
          <span *ngIf="req.status !== 'pending' && req.comment" class="comment-display">Comment: {{ req.comment }}</span>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    <div *ngIf="requests.length === 0" class="empty">No password reset requests.</div>
  </div>
</div>
